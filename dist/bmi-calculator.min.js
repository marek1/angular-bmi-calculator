"use strict";var bmiModule=angular.module("bmiModule",[]).constant("metric",["m","cm","kg","g"]).constant("imperial",["ft","in","st","lb"]).constant("imperialMetricMap",{kg:{g:1e3,st:.157473,lb:2.20462},g:{kg:.001,st:157473e-9,lb:.00220462},st:{kg:6.35029,g:6350.29,lb:14},lb:{kg:.453592,g:453.592,st:.0714286},m:{cm:100,ft:3.28084,"in":39.3701},cm:{m:.01,ft:.0328084,"in":.393701},ft:{m:.3048,cm:30.48,"in":12},"in":{m:.0254,cm:2.54,ft:.0833333}}).service("BmiCalculatorService",["imperialMetricMap",function(t){this.convert=function(e,r,a){return isNaN(a)?void 0:a*t[e][r]}}]).controller("BmiCalculatorController",["$scope","$timeout","BmiCalculatorService","metric","imperial",function(t,e,r,a,i){var l={metric:function(){t.ctrl.userData.bmi=!t.ctrl.userData.weight.kg||isNaN(t.ctrl.userData.weight.kg)||!t.ctrl.userData.height.cm||isNaN(t.ctrl.userData.height.cm)||parseInt(t.ctrl.userData.weight.kg)<=0||parseInt(t.ctrl.userData.height.cm)<=0?0:parseFloat(parseFloat(t.ctrl.userData.weight.kg)/Math.pow(parseFloat(parseFloat(t.ctrl.userData.height.cm)/100),2)).toFixed(1)},imperial:function(){t.ctrl.userData.bmi=!t.ctrl.userData.weight.st&&!t.ctrl.userData.weight.lb||isNaN(t.ctrl.userData.weight.st)||isNaN(t.ctrl.userData.weight.lb)||parseInt(t.ctrl.userData.weight.st)<=0&&parseInt(t.ctrl.userData.weight.lb)<=0||!t.ctrl.userData.height.ft&&!t.ctrl.userData.height["in"]||isNaN(t.ctrl.userData.height.ft)||isNaN(t.ctrl.userData.height["in"])||parseInt(t.ctrl.userData.height.ft)<=0&&parseInt(t.ctrl.userData.height["in"])<=0?0:(703*(parseFloat(r.convert("st","lb",t.ctrl.userData.weight.st?t.ctrl.userData.weight.st:0))+parseFloat(t.ctrl.userData.weight.lb?t.ctrl.userData.weight.lb:0))/Math.pow(parseFloat(r.convert("ft","in",t.ctrl.userData.height.ft?t.ctrl.userData.height.ft:0))+parseFloat(t.ctrl.userData.height["in"]?t.ctrl.userData.height["in"]:0),2)).toFixed(1)}};t.ctrl.userData=t.ctrl.userData||{height:{m:0,cm:0,ft:0,"in":0},weight:{kg:0,g:0,st:0,lb:0},unit:"metric",bmi:0},t.metricHeight="cm",t.metricWeight="kg";var c=function(e,a){for(var c in t.ctrl.userData[e])if(!t.ctrl.userData[e][c]||a!==c)for(var s in t.ctrl.userData[e])c!==s&&t.ctrl.userData[e][s]&&!isNaN(t.ctrl.userData[e][s])&&("height"===e&&("cm"!==c&&"m"!==c||"cm"!==s&&"m"!==s||(t.ctrl.userData.height[c]=parseFloat(r.convert(s,c,t.ctrl.userData.height[s])).toFixed(2)),"ft"===a||"in"===a||"ft"!==c&&"in"!==c||"m"!==s&&"cm"!==s||(t.ctrl.userData.height.ft=Math.floor(r.convert(s,"ft",t.ctrl.userData.height[s])),t.ctrl.userData.height["in"]=parseFloat(parseFloat("0."+r.convert(s,"ft",t.ctrl.userData.height[s]).toString().replace(",",".").split(".")[1])*r.convert("ft","in",1)).toFixed(4)),("undefined"==typeof a||i.indexOf(a)>-1)&&("m"!==c&&"cm"!==c||"ft"!==s||(t.ctrl.userData.height[c]=parseFloat(r.convert("ft",c,parseFloat(t.ctrl.userData.height.ft)+parseFloat(parseFloat(t.ctrl.userData.height["in"])/r.convert("ft","in",1)))).toFixed(2)))),"weight"===e&&("kg"!==c&&"g"!==c||"kg"!==s&&"g"!==s||(t.ctrl.userData.weight[c]=parseFloat(r.convert(s,c,t.ctrl.userData.weight[s])).toFixed(2)),"st"===a||"lb"===a||"st"!==c&&"lb"!==c||"kg"!==s&&"g"!==s||(t.ctrl.userData.weight.st=Math.floor(r.convert(s,"st",t.ctrl.userData.weight[s])),t.ctrl.userData.weight.lb=parseFloat(parseFloat("0."+r.convert(s,"st",t.ctrl.userData.weight[s]).toString().replace(",",".").split(".")[1])*r.convert("st","lb",1)).toFixed(4)),("undefined"==typeof a||i.indexOf(a)>-1)&&("kg"!==c&&"g"!==c||"st"!==s||(t.ctrl.userData.weight[c]=parseFloat(r.convert("st",c,parseFloat(t.ctrl.userData.weight.st)+parseFloat(parseFloat(t.ctrl.userData.weight.lb)/r.convert("st","lb",1)))).toFixed(2)))));l.metric()};c("height"),c("weight"),t.changedValue=function(e,r){var i=a.indexOf(r)>-1?t.bmiform.metric:t.bmiform.imperial;if("undefined"!=typeof r){var l=i[r].$viewValue;isNaN(l)||parseFloat(l)<0?i[r].$setValidity("required",!1):(i[r].$setValidity("required",!0),c(e,r))}},t.translate={cm:function(t){return t+" cm"},kg:function(t){return t+" kg"},ft:function(t){return t+" ft"},"in":function(t){return t+" in"},st:function(t){return t+" st"},lb:function(t){return t+" lb"}},t.$on("slideEnded",function(t){e(function(){c(t.targetScope.rzSliderUnitType,t.targetScope.rzSliderUnit)},1)})}]).directive("bmiCalculator",function(){return{restrict:"EA",controller:"BmiCalculatorController",controllerAs:"ctrl",bindToController:!0,scope:{userData:"=",displayType:"@"},templateUrl:"bmi-calculator.html",link:function(t,e){}}});